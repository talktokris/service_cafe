import{r as h,j as e,b as F}from"./app-CeALoAiy.js";function B({onClose:b,onSuccess:f,officeProfiles:j=[]}){const[a,N]=h.useState({headOfficeId:"",branchId:"",menuName:"",menuType:"food",drinkAmount:0,buyingPrice:0,adminProfitPercentage:0,adminProfitAmount:0,userCommissionPercentage:0,userCommissionAmount:0,sellingPrice:0,govTaxPercentage:0,govTaxAmount:0,sellingWithTaxPrice:0,activeStatus:1}),[t,o]=h.useState({}),[u,x]=h.useState(!1),v=j.filter(s=>s.profileType==="HeadOffice"&&s.deleteStatus===0),C=j.filter(s=>s.profileType==="BranchOffice"&&s.deleteStatus===0),i=s=>{const{name:n,value:m,type:d,checked:O}=s.target,c=d==="checkbox"?O:m;N(l=>{const r={...l,[n]:c};if(n==="buyingPrice"||n==="adminProfitPercentage"||n==="userCommissionPercentage"||n==="govTaxPercentage"){const p=n==="buyingPrice"?parseFloat(c)||0:parseFloat(l.buyingPrice)||0,A=n==="adminProfitPercentage"?parseFloat(c)||0:parseFloat(l.adminProfitPercentage)||0,S=n==="userCommissionPercentage"?parseFloat(c)||0:parseFloat(l.userCommissionPercentage)||0,k=n==="govTaxPercentage"?parseFloat(c)||0:parseFloat(l.govTaxPercentage)||0,P=Math.round(A/100*p*100)/100;r.adminProfitAmount=P;const g=Math.round((p+P)*100)/100;r.sellingPrice=g;const I=Math.round(S/100*p*100)/100;r.userCommissionAmount=I;const y=Math.round(k/100*g*100)/100;r.govTaxAmount=y;const M=Math.round((g+y)*100)/100;r.sellingWithTaxPrice=M}return r}),t[n]&&o(l=>({...l,[n]:null}))},T=()=>{const s={};return a.headOfficeId||(s.headOfficeId="Head Office is required"),a.menuName||(s.menuName="Menu name is required"),a.menuType||(s.menuType="Menu type is required"),a.buyingPrice<0&&(s.buyingPrice="Buying price cannot be negative"),a.sellingPrice<0&&(s.sellingPrice="Selling price cannot be negative"),(a.adminProfitPercentage<0||a.adminProfitPercentage>100)&&(s.adminProfitPercentage="Admin profit percentage must be between 0 and 100"),(a.userCommissionPercentage<0||a.userCommissionPercentage>100)&&(s.userCommissionPercentage="User commission percentage must be between 0 and 100"),o(s),Object.keys(s).length===0},w=async s=>{if(s.preventDefault(),!!T()){x(!0);try{F.post("/menu-items",a,{onSuccess:n=>{var m;if((m=n.props.flash)!=null&&m.success&&console.log("Success message:",n.props.flash.success),console.log("Page props received:",n.props),n.props.menuItem)console.log("Using menuItem from page props:",n.props.menuItem),f(n.props.menuItem);else{const d={id:Date.now(),...a,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("Using mock menu item:",d),f(d)}},onError:n=>{o(n)},onFinish:()=>{x(!1)}})}catch(n){console.error("Error creating menu item:",n),x(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Menu Item"}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Office Selection"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Head Office *"})}),e.jsxs("select",{name:"headOfficeId",value:a.headOfficeId,onChange:i,className:`select select-bordered w-full ${t.headOfficeId?"select-error":""}`,children:[e.jsx("option",{value:"",children:"Select Head Office"}),v.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]}),t.headOfficeId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.headOfficeId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Branch Office"})}),e.jsxs("select",{name:"branchId",value:a.branchId,onChange:i,className:"select select-bordered w-full",children:[e.jsx("option",{value:"",children:"Select Branch Office (Optional)"}),C.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Menu Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Menu Name *"})}),e.jsx("input",{type:"text",name:"menuName",value:a.menuName,onChange:i,className:`input input-bordered w-full ${t.menuName?"input-error":""}`,placeholder:"e.g., Chicken Burger, Coffee"}),t.menuName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.menuName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Menu Type *"})}),e.jsxs("select",{name:"menuType",value:a.menuType,onChange:i,className:`select select-bordered w-full ${t.menuType?"select-error":""}`,children:[e.jsx("option",{value:"food",children:"Food"}),e.jsx("option",{value:"drink",children:"Drink"})]}),t.menuType&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.menuType})]})]}),a.menuType==="drink"&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Drink Amount (ml)"})}),e.jsx("input",{type:"number",name:"drinkAmount",value:a.drinkAmount,onChange:i,className:"input input-bordered w-full",placeholder:"e.g., 250",step:"0.01"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Pricing Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Buying Price (₹)"})}),e.jsx("input",{type:"number",name:"buyingPrice",value:a.buyingPrice,onChange:i,className:`input input-bordered w-full ${t.buyingPrice?"input-error":""}`,placeholder:"0.00",step:"0.01",min:"0"}),t.buyingPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.buyingPrice})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Selling Price (₹)"})}),e.jsx("input",{type:"number",name:"sellingPrice",value:a.sellingPrice,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"}),t.sellingPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.sellingPrice})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Profit & Commission"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Admin Profit Percentage (%)"})}),e.jsx("input",{type:"number",name:"adminProfitPercentage",value:a.adminProfitPercentage,onChange:i,className:`input input-bordered w-full ${t.adminProfitPercentage?"input-error":""}`,placeholder:"0",min:"0",max:"100"}),t.adminProfitPercentage&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.adminProfitPercentage})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Admin Profit Amount (₹)"})}),e.jsx("input",{type:"number",name:"adminProfitAmount",value:a.adminProfitAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"User Commission Percentage (%)"})}),e.jsx("input",{type:"number",name:"userCommissionPercentage",value:a.userCommissionPercentage,onChange:i,className:`input input-bordered w-full ${t.userCommissionPercentage?"input-error":""}`,placeholder:"0",min:"0",max:"100"}),t.userCommissionPercentage&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.userCommissionPercentage})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"User Commission Amount (₹)"})}),e.jsx("input",{type:"number",name:"userCommissionAmount",value:a.userCommissionAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Government Tax"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Government Tax Percentage (%)"})}),e.jsx("input",{type:"number",name:"govTaxPercentage",value:a.govTaxPercentage,onChange:i,className:"input input-bordered w-full",placeholder:"0",min:"0",max:"100",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Government Tax Amount (₹)"})}),e.jsx("input",{type:"number",name:"govTaxAmount",value:a.govTaxAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Selling Price with Tax (₹)"})}),e.jsx("input",{type:"number",name:"sellingWithTaxPrice",value:a.sellingWithTaxPrice,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Status"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"activeStatus",checked:a.activeStatus===1,onChange:s=>N(n=>({...n,activeStatus:s.target.checked?1:0})),className:"checkbox checkbox-primary mr-3"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active Status"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:b,className:"btn btn-ghost",disabled:u,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Creating..."]}):"Create Menu Item"})]})]})]})})}export{B as default};
