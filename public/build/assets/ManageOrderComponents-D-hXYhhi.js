import{r as a,j as e}from"./app-C-EhCx0Q.js";import V from"./ViewOrderComponents-BRkhci50.js";import F from"./PrintReceiptComponents-B16vddEA.js";import"./ViewOrderItemComponents-Coin8UfT.js";function q({orders:n=[],officeProfiles:b=[]}){const[x,w]=a.useState(n);console.log("ManageOrderComponents - All orders data:",n),console.log("ManageOrderComponents - Order 6 specifically:",n.find(t=>t.id===6));const[l,S]=a.useState(""),[i,O]=a.useState(""),[c,C]=a.useState(""),[d,k]=a.useState(""),[o,D]=a.useState(""),[p,j]=a.useState(null),[I,g]=a.useState(!1),[T,f]=a.useState(!1),[u,N]=a.useState(null);a.useEffect(()=>{let t=n;l&&(t=t.filter(s=>s.id.toString().includes(l)||s.memberUserId&&s.memberUserId.toString().includes(l)||s.tableId&&s.tableId.toString().includes(l))),i&&(t=t.filter(s=>s.headOfficeId&&s.headOfficeId.toString()===i)),c&&(t=t.filter(s=>s.branchId&&s.branchId.toString()===c)),d&&(t=t.filter(s=>new Date(s.created_at)>=new Date(d))),o&&(t=t.filter(s=>new Date(s.created_at)<=new Date(o))),t=t.slice(0,100),w(t)},[n,l,i,c,d,o]);const M=t=>{j(t),g(!0)},P=t=>{var r;const s={id:t.tableId,tableShortName:((r=t.table)==null?void 0:r.tableShortName)||`Table ${t.tableId}`};N({order:t,table:s}),f(!0)},A=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(t||0),B=t=>new Date(t).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),U=t=>t.paymentStatus===1?e.jsx("span",{className:"badge badge-success",children:"Completed"}):t.tableOccupiedStatus===1?e.jsx("span",{className:"badge badge-warning",children:"Processing"}):e.jsx("span",{className:"badge badge-error",children:"Cancelled"}),$=t=>{var r,y,v;if(t.customerType==="member"&&t.memberUser){const m=((r=t.memberUser)==null?void 0:r.first_name)||"",h=((y=t.memberUser)==null?void 0:y.last_name)||"";return{name:`${m} ${h}`.trim()||"Member User",email:((v=t.memberUser)==null?void 0:v.email)||"N/A",initials:`${(m==null?void 0:m[0])||""}${(h==null?void 0:h[0])||""}`||"MU",color:"bg-purple-600"}}else return{name:"Walking Customer",email:"N/A",initials:"WC",color:"bg-gray-600"}},H=b.filter(t=>t.profileType==="HeadOffice"),L=b.filter(t=>t.profileType==="BranchOffice");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Search & Filter Orders"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search (Order ID, Member ID, Table ID)"}),e.jsx("input",{type:"text",value:l,onChange:t=>S(t.target.value),placeholder:"Search orders...",className:"input input-bordered w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Head Office"}),e.jsxs("select",{value:i,onChange:t=>O(t.target.value),className:"select select-bordered w-full",children:[e.jsx("option",{value:"",children:"All Head Offices"}),H.map(t=>e.jsx("option",{value:t.id,children:t.companyName||`Office ${t.id}`},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Branch Office"}),e.jsxs("select",{value:c,onChange:t=>C(t.target.value),className:"select select-bordered w-full",children:[e.jsx("option",{value:"",children:"All Branches"}),L.map(t=>e.jsx("option",{value:t.id,children:t.companyName||`Branch ${t.id}`},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),e.jsx("input",{type:"date",value:d,onChange:t=>k(t.target.value),className:"input input-bordered w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),e.jsx("input",{type:"date",value:o,onChange:t=>D(t.target.value),className:"input input-bordered w-full"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Recent Orders (",x.length,")"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Showing latest 100 orders"})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-zebra w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order ID"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Table"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Payment Method"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:x.length>0?x.map(t=>{const s=$(t);return e.jsxs("tr",{children:[e.jsxs("td",{className:"font-mono",children:["#",t.id]}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"mask mask-squircle w-12 h-12",children:e.jsx("div",{className:`w-12 h-12 ${s.color} text-white flex items-center justify-center rounded-full`,children:e.jsx("span",{className:"text-sm font-semibold",children:s.initials})})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold",children:s.name}),e.jsx("div",{className:"text-sm opacity-50",children:s.email})]})]})}),e.jsx("td",{children:t.table?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.table.tableShortName}),e.jsx("div",{className:"text-sm text-gray-500",children:t.table.tableShortFullName})]}):e.jsx("span",{className:"text-gray-400",children:"N/A"})}),e.jsx("td",{className:"font-medium",children:A(t.sellingPrice)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${t.paymentType==="cash"?"badge-warning":t.paymentType==="online"?"badge-info":t.paymentType==="wallet"?"badge-primary":"badge-ghost"}`,children:t.paymentType?t.paymentType.charAt(0).toUpperCase()+t.paymentType.slice(1):"N/A"})}),e.jsx("td",{children:U(t)}),e.jsx("td",{className:"text-sm",children:B(t.created_at)}),e.jsx("td",{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>M(t),className:"btn btn-ghost btn-xs text-blue-600 hover:bg-blue-50",title:"View Order Details",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]}),t.paymentStatus===1&&e.jsxs("button",{onClick:()=>P(t),className:"btn btn-ghost btn-xs text-gray-600 hover:bg-gray-50",title:"Print Receipt",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print"]})]})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"No orders found"})})})]})})})]}),I&&p&&e.jsx(V,{order:p,onClose:()=>{g(!1),j(null)}}),T&&u&&e.jsx(F,{table:u.table,order:u.order,onClose:()=>{f(!1),N(null)}})]})}export{q as default};
