import{r as a,j as e}from"./app-GQ-hLdfW.js";import z from"./CreateStockRecordComponents-WNPPWeTf.js";import q from"./ViewStockRecordComponents-CjbZ8OhN.js";import Q from"./EditStockRecordComponents-CFQMdX6H.js";import G from"./DeleteStockRecordComponents-DOVgHaxw.js";function P({user:J,stockRecords:m=[],officeProfiles:d=[],stockItemSettings:x=[]}){const[n,u]=a.useState(m),[M,j]=a.useState(!1),[O,k]=a.useState(!1),[A,f]=a.useState(!1),[R,g]=a.useState(!1),[o,r]=a.useState(null),[b,w]=a.useState("all"),[p,y]=a.useState("all"),[N,S]=a.useState("all"),[c,i]=a.useState(m);a.useEffect(()=>{u(m),i(m)},[m]);const T=d.filter(s=>s.profileType==="HeadOffice"&&s.deleteStatus===0),D=d.filter(s=>s.profileType==="BranchOffice"&&s.deleteStatus===0),L=()=>{const s=n.filter(t=>{const l=b==="all"||t.headOfficeId==b,h=p==="all"||t.branchId==p,$=N==="all"||t.stockItemSettingId==N;return l&&h&&$&&t.deleteStatus===0});i(s)},B=()=>{w("all"),y("all"),S("all"),i(n.filter(s=>s.deleteStatus===0))},F=s=>{console.log("New stock record received in handleCreateStockRecord:",s),console.log("Current stock records before update:",n),console.log("Current filtered data before update:",c),u(t=>{const l=[...t,s];return console.log("Updated stock records:",l),l}),i(t=>{const l=[...t,s];return console.log("Updated filtered records:",l),l}),j(!1)},I=s=>{u(n.map(t=>t.id===s.id?s:t)),i(c.map(t=>t.id===s.id?s:t)),f(!1),r(null)},V=s=>{console.log("Deleting stock record with ID:",s),console.log("Current stock records before delete:",n),console.log("Current filtered data before delete:",c),u(n.map(t=>t.id===s?{...t,deleteStatus:1}:t)),i(c.filter(t=>t.id!==s)),console.log("After delete - filtered data should be updated"),g(!1),r(null)},E=s=>{r(s),k(!0)},H=s=>{r(s),f(!0)},W=s=>{r(s),g(!0)},C=(s,t)=>{if(!s)return"N/A";const l=d.find(h=>h.id==s);return l?l.companyName:"Unknown"},U=s=>{if(!s)return"N/A";const t=x.find(l=>l.id==s);return t?t.itemName:"Unknown"},v=s=>{const t=parseFloat(s)||0;return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(t)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Stock Records Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage stock records for head offices and branch offices"})]}),e.jsxs("button",{onClick:()=>j(!0),className:"btn bg-red-600 hover:bg-red-700 text-white",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add New Stock Record"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Stock Records"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(s=>s.deleteStatus===0).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Food Records"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(s=>s.itemType==="food"&&s.deleteStatus===0).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Drink Records"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(s=>s.itemType==="drink"&&s.deleteStatus===0).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:(()=>{const s=n.filter(t=>t.deleteStatus===0).reduce((t,l)=>{const h=parseFloat(l.itemAmountTotal)||0;return console.log(`Record ${l.id}: itemAmountTotal = ${l.itemAmountTotal}, parsed = ${h}`),t+h},0);return console.log("Total value calculated:",s),v(s)})()})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Head Office"})}),e.jsxs("select",{value:b,onChange:s=>w(s.target.value),className:"select select-bordered w-full",children:[e.jsx("option",{value:"all",children:"All Head Offices"}),T.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Branch Office"})}),e.jsxs("select",{value:p,onChange:s=>y(s.target.value),className:"select select-bordered w-full",children:[e.jsx("option",{value:"all",children:"All Branch Offices"}),D.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Stock Item"})}),e.jsxs("select",{value:N,onChange:s=>S(s.target.value),className:"select select-bordered w-full",children:[e.jsx("option",{value:"all",children:"All Stock Items"}),x.map(s=>e.jsx("option",{value:s.id,children:s.itemName},s.id))]})]}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsx("button",{onClick:L,className:"btn btn-primary",children:"Filter"}),e.jsx("button",{onClick:B,className:"btn btn-ghost",children:"Reset"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Stock Records (",c.length,")"]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-zebra w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Stock Item"}),e.jsx("th",{children:"Item Type"}),e.jsx("th",{children:"Head Office"}),e.jsx("th",{children:"Branch Office"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Total Value"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"No stock records found"})}):c.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"font-bold",children:U(s.stockItemSettingId)})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.itemType==="food"?"badge-primary":"badge-secondary"}`,children:s.itemType})}),e.jsx("td",{children:C(s.headOfficeId)}),e.jsx("td",{children:C(s.branchId)}),e.jsx("td",{children:e.jsx("span",{className:"font-medium",children:s.quantity||0})}),e.jsx("td",{children:e.jsx("span",{className:"font-medium text-green-600",children:v(s.itemAmount)})}),e.jsx("td",{children:e.jsx("span",{className:"font-medium text-blue-600",children:v(s.itemAmountTotal)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>E(s),className:"btn btn-ghost btn-xs text-green-600 hover:bg-green-50",children:"View"}),e.jsx("button",{onClick:()=>H(s),className:"btn btn-ghost btn-xs text-blue-600 hover:bg-blue-50",children:"Edit"}),e.jsx("button",{onClick:()=>W(s),className:"btn btn-ghost btn-xs text-red-600 hover:bg-red-50",children:"Delete"})]})})]},s.id))})]})})})]}),M&&e.jsx(z,{onClose:()=>j(!1),onSuccess:F,officeProfiles:d,stockItemSettings:x}),O&&o&&e.jsx(q,{stockRecord:o,onClose:()=>{k(!1),r(null)},officeProfiles:d,stockItemSettings:x}),A&&o&&e.jsx(Q,{stockRecord:o,onClose:()=>{f(!1),r(null)},onSuccess:I,officeProfiles:d,stockItemSettings:x}),R&&o&&e.jsx(G,{stockRecord:o,onClose:()=>{g(!1),r(null)},onSuccess:V})]})}export{P as default};
