import{a as C,r as N,j as e}from"./app-C-EhCx0Q.js";function M({menuItem:t,onClose:x,onSuccess:v}){var u,g,b,h;const{auth:l}=C().props,w=l==null?void 0:l.user,[s,r]=N.useState(t.quantity||1),[i,m]=N.useState(!1),n=a=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a||0),P=async a=>{var j,p;if(a.preventDefault(),!w||!t.id){alert("User session or menu item not found");return}m(!0);try{const c=((j=document.querySelector('meta[name="csrf-token"]'))==null?void 0:j.getAttribute("content"))||"",k=((p=t.menuItem)==null?void 0:p.govTaxPercentage)||0,o=Math.round(k/100*t.sellingPrice*s*100)/100,f=Math.round((t.sellingPrice*s+o)*100)/100,T={quantity:s,subTotalAmount:f,taxAmount:o},d=await fetch(`/order-items/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":c,Accept:"application/json"},body:JSON.stringify(T)});if(d.ok){const y=await d.json();v({...t,quantity:s,subTotalAmount:f,taxAmount:o})}else{const y=await d.json();alert(y.message||"Failed to update menu item")}}catch(c){console.error("Error updating menu item:",c),alert("An error occurred while updating the menu item")}finally{m(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Menu Item"}),e.jsx("button",{onClick:x,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:P,className:"p-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Menu Item Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Menu Item"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:((u=t.menuItem)==null?void 0:u.menuName)||"Unknown Item"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Price"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:n(t.sellingPrice)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Current Quantity"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.quantity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Current Total"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:n(t.subTotalAmount||t.sellingPrice*t.quantity)})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 mb-2 block",children:"Update Quantity"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>r(Math.max(1,s-1)),className:"btn btn-outline btn-lg",children:"-"}),e.jsx("div",{className:"text-center",children:e.jsx("input",{type:"number",value:s,onChange:a=>r(parseInt(a.target.value)||1),className:"input input-bordered text-center text-2xl font-bold w-24",min:"1"})}),e.jsx("button",{type:"button",onClick:()=>r(s+1),className:"btn btn-outline btn-lg",children:"+"})]})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Subtotal:"}),e.jsx("span",{className:"text-lg font-semibold text-gray-700",children:n(t.sellingPrice*s)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["Tax (",((g=t.menuItem)==null?void 0:g.govTaxPercentage)||0,"%):"]}),e.jsx("span",{className:"text-lg font-semibold text-orange-600",children:n((((b=t.menuItem)==null?void 0:b.govTaxPercentage)||0)/100*t.sellingPrice*s)})]}),e.jsxs("div",{className:"flex justify-between items-center border-t border-gray-200 pt-2",children:[e.jsx("span",{className:"text-lg font-medium text-gray-700",children:"New Total:"}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:n(t.sellingPrice*s+(((h=t.menuItem)==null?void 0:h.govTaxPercentage)||0)/100*t.sellingPrice*s)})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:x,className:"btn btn-ghost",disabled:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Updating..."]}):"Update Item"})]})]})]})})}export{M as default};
