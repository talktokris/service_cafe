import{r as m,j as e,b as g}from"./app-BF4HM74z.js";function v({user:s,onClose:h,onSuccess:x,officeProfiles:N=[]}){const[r,u]=m.useState({role:""}),[t,c]=m.useState({}),[d,o]=m.useState(!1),f=()=>s.headOfficeId&&s.branchId?[{value:"Branch Admin User",label:"Branch Admin User"},{value:"Branch Billing User",label:"Branch Billing User"}]:s.headOfficeId?[{value:"Super User",label:"Super User"},{value:"Admin User",label:"Admin User"},{value:"Account User",label:"Account User"},{value:"Billing User",label:"Billing User"}]:[],j=a=>{const{name:l,value:i}=a.target;u(n=>({...n,[l]:i})),t[l]&&c(n=>({...n,[l]:null}))},b=()=>{const a={};return r.role||(a.role="Role is required"),c(a),Object.keys(a).length===0},p=async a=>{if(a.preventDefault(),!!b()){o(!0);try{g.post(`/users/${s.id}/change-role`,r,{onSuccess:l=>{var i;if((i=l.props.flash)!=null&&i.success&&console.log("Success message:",l.props.flash.success),l.props.user)x(l.props.user);else{const n={...s,role:r.role,updated_at:new Date().toISOString()};x(n)}},onError:l=>{c(l)},onFinish:()=>{o(!1)}})}catch(l){console.error("Error changing role:",l),o(!1)}}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Change Role"}),e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"User Information:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Name:"}),e.jsxs("span",{className:"font-medium",children:[s.first_name," ",s.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("span",{className:"font-medium",children:s.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"User Type:"}),e.jsx("span",{className:"font-medium",children:e.jsx("span",{className:`badge ${s.user_type==="headoffice"?"badge-primary":"badge-secondary"}`,children:s.user_type==="headoffice"?"Head Office":s.user_type==="branchOffice"?"Branch Office":s.user_type})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Current Role:"}),e.jsx("span",{className:"font-medium",children:s.roles&&s.roles.length>0?s.roles[0].name:"No Role"})]})]})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"New Role *"})}),e.jsxs("select",{name:"role",value:r.role,onChange:j,className:`select select-bordered w-full ${t.role?"select-error":""}`,children:[e.jsx("option",{value:"",children:"Select New Role"}),f().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]}),t.role&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.role})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-900 mb-2",children:"Available Roles:"}),e.jsx("ul",{className:"text-xs text-blue-800 space-y-1",children:s.headOfficeId&&s.branchId?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"• Branch Admin User - Full access to branch operations"}),e.jsx("li",{children:"• Branch Billing User - Billing and payment access"})]}):s.headOfficeId?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"• Super User - Full system access"}),e.jsx("li",{children:"• Admin User - Administrative access"}),e.jsx("li",{children:"• Account User - Account management access"}),e.jsx("li",{children:"• Billing User - Billing and payment access"})]}):e.jsx("li",{children:"• No roles available - User must be assigned to an office"})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:h,className:"btn btn-ghost",disabled:d,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Changing..."]}):"Change Role"})]})]})]})]})}):null}export{v as default};
