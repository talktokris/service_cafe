import{r as m,U as M,j as e,b as W}from"./app-C-EhCx0Q.js";function T({stockRecord:i,onClose:g,onSuccess:b,officeProfiles:j=[],stockItemSettings:f=[]}){const[s,r]=m.useState({headOfficeId:"",branchId:"",stockItemSettingId:"",itemType:"food",itemAmount:0,itemMassWeightKG:0,itemLiquidWeightML:0,quantity:0,itemAmountTotal:0,itemMassWeightKGTotal:0,itemLiquidWeightMLTotal:0,activeStatus:1}),[l,o]=m.useState({}),[u,h]=m.useState(!1),y=j.filter(t=>t.profileType==="HeadOffice"&&t.deleteStatus===0),N=j.filter(t=>t.profileType==="BranchOffice"&&t.deleteStatus===0);m.useEffect(()=>{i&&r({headOfficeId:i.headOfficeId||"",branchId:i.branchId||"",stockItemSettingId:i.stockItemSettingId||"",itemType:i.itemType||"food",itemAmount:i.itemAmount||0,itemMassWeightKG:i.itemMassWeightKG||0,itemLiquidWeightML:i.itemLiquidWeightML||0,quantity:i.quantity||0,itemAmountTotal:i.itemAmountTotal||0,itemMassWeightKGTotal:i.itemMassWeightKGTotal||0,itemLiquidWeightMLTotal:i.itemLiquidWeightMLTotal||0,activeStatus:i.activeStatus||0})},[i]);const d=t=>{const{name:a,value:n,type:c,checked:x}=t.target;r(p=>({...p,[a]:c==="checkbox"?x:n})),l[a]&&o(p=>({...p,[a]:null}))},v=t=>{const a=t.target.value,n=f.find(c=>c.id==a);r(c=>({...c,stockItemSettingId:a,itemType:n?n.itemType:"food"}))},I=()=>{const t=parseFloat(s.quantity)||0,a=parseFloat(s.itemAmount)||0,n=parseFloat(s.itemMassWeightKG)||0,c=parseFloat(s.itemLiquidWeightML)||0;r(x=>({...x,itemAmountTotal:a*t,itemMassWeightKGTotal:n*t,itemLiquidWeightMLTotal:c*t}))};M.useEffect(()=>{I()},[s.quantity,s.itemAmount,s.itemMassWeightKG,s.itemLiquidWeightML]);const S=()=>{const t={};return s.headOfficeId||(t.headOfficeId="Head Office is required"),s.stockItemSettingId||(t.stockItemSettingId="Stock Item is required"),s.itemAmount<0&&(t.itemAmount="Item amount cannot be negative"),s.quantity<0&&(t.quantity="Quantity cannot be negative"),o(t),Object.keys(t).length===0},L=async t=>{if(t.preventDefault(),!!S()){h(!0);try{W.put(`/stock-records/${i.id}`,s,{onSuccess:a=>{var n;if((n=a.props.flash)!=null&&n.success&&console.log(a.props.flash.success),a.props.stockRecord)b(a.props.stockRecord);else{const c={...i,...s,updated_at:new Date().toISOString()};b(c)}},onError:a=>{o(a)},onFinish:()=>{h(!1)}})}catch(a){console.error("Error updating stock record:",a),h(!1)}}};return i?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Stock Record"}),e.jsx("button",{onClick:g,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:L,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Office Selection"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Head Office *"})}),e.jsxs("select",{name:"headOfficeId",value:s.headOfficeId,onChange:d,className:`select select-bordered w-full ${l.headOfficeId?"select-error":""}`,children:[e.jsx("option",{value:"",children:"Select Head Office"}),y.map(t=>e.jsx("option",{value:t.id,children:t.companyName},t.id))]}),l.headOfficeId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.headOfficeId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Branch Office"})}),e.jsxs("select",{name:"branchId",value:s.branchId,onChange:d,className:"select select-bordered w-full",children:[e.jsx("option",{value:"",children:"Select Branch Office (Optional)"}),N.map(t=>e.jsx("option",{value:t.id,children:t.companyName},t.id))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Stock Item Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Stock Item *"})}),e.jsxs("select",{name:"stockItemSettingId",value:s.stockItemSettingId,onChange:v,className:`select select-bordered w-full ${l.stockItemSettingId?"select-error":""}`,children:[e.jsx("option",{value:"",children:"Select Stock Item"}),f.map(t=>e.jsxs("option",{value:t.id,children:[t.itemName," (",t.itemType,")"]},t.id))]}),l.stockItemSettingId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.stockItemSettingId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Item Type"})}),e.jsx("input",{type:"text",value:s.itemType,className:"input input-bordered w-full bg-gray-100",readOnly:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-filled based on selected stock item"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Item Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Item Amount (Rs)"})}),e.jsx("input",{type:"number",name:"itemAmount",value:s.itemAmount,onChange:d,className:`input input-bordered w-full ${l.itemAmount?"input-error":""}`,placeholder:"0.00",step:"0.01",min:"0"}),l.itemAmount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.itemAmount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Mass Weight (KG)"})}),e.jsx("input",{type:"number",name:"itemMassWeightKG",value:s.itemMassWeightKG,onChange:d,className:"input input-bordered w-full",placeholder:"0",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Liquid Weight (ML)"})}),e.jsx("input",{type:"number",name:"itemLiquidWeightML",value:s.itemLiquidWeightML,onChange:d,className:"input input-bordered w-full",placeholder:"0",min:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Quantity *"})}),e.jsx("input",{type:"number",name:"quantity",value:s.quantity,onChange:d,className:`input input-bordered w-full ${l.quantity?"input-error":""}`,placeholder:"0",min:"0"}),l.quantity&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.quantity})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Calculated Totals"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Total Amount (Rs)"})}),e.jsx("input",{type:"number",value:s.itemAmountTotal,className:"input input-bordered w-full bg-gray-100",readOnly:!0,step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Total Mass Weight (KG)"})}),e.jsx("input",{type:"number",value:s.itemMassWeightKGTotal,className:"input input-bordered w-full bg-gray-100",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Total Liquid Weight (ML)"})}),e.jsx("input",{type:"number",value:s.itemLiquidWeightMLTotal,className:"input input-bordered w-full bg-gray-100",readOnly:!0})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Status"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"activeStatus",checked:s.activeStatus===1,onChange:t=>r(a=>({...a,activeStatus:t.target.checked?1:0})),className:"checkbox checkbox-primary mr-3"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active Status"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:g,className:"btn btn-ghost",disabled:u,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Updating..."]}):"Update Stock Record"})]})]})]})}):null}export{T as default};
