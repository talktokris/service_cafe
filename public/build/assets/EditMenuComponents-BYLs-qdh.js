import{r as m,j as e,b as W}from"./app-CeALoAiy.js";function D({menuItem:i,onClose:j,onSuccess:P,officeProfiles:N=[]}){const[a,u]=m.useState({headOfficeId:"",branchId:"",menuName:"",menuType:"food",drinkAmount:0,buyingPrice:0,adminProfitPercentage:0,adminProfitAmount:0,userCommissionPercentage:0,userCommissionAmount:0,sellingPrice:0,govTaxPercentage:0,govTaxAmount:0,sellingWithTaxPrice:0,activeStatus:1}),[r,x]=m.useState({}),[g,h]=m.useState(!1),C=N.filter(s=>s.profileType==="HeadOffice"&&s.deleteStatus===0),T=N.filter(s=>s.profileType==="BranchOffice"&&s.deleteStatus===0);m.useEffect(()=>{i&&u({headOfficeId:i.headOfficeId||"",branchId:i.branchId||"",menuName:i.menuName||"",menuType:i.menuType||"food",drinkAmount:i.drinkAmount||0,buyingPrice:i.buyingPrice||0,adminProfitPercentage:i.adminProfitPercentage||0,adminProfitAmount:i.adminProfitAmount||0,userCommissionPercentage:i.userCommissionPercentage||0,userCommissionAmount:i.userCommissionAmount||0,sellingPrice:i.sellingPrice||0,govTaxPercentage:i.govTaxPercentage||0,govTaxAmount:i.govTaxAmount||0,sellingWithTaxPrice:i.sellingWithTaxPrice||0,activeStatus:i.activeStatus||0})},[i]);const t=s=>{const{name:n,value:o,type:p,checked:O}=s.target,d=p==="checkbox"?O:o;u(l=>{const c={...l,[n]:d};if(n==="buyingPrice"||n==="adminProfitPercentage"||n==="userCommissionPercentage"||n==="govTaxPercentage"){const b=n==="buyingPrice"?parseFloat(d)||0:parseFloat(l.buyingPrice)||0,k=n==="adminProfitPercentage"?parseFloat(d)||0:parseFloat(l.adminProfitPercentage)||0,S=n==="userCommissionPercentage"?parseFloat(d)||0:parseFloat(l.userCommissionPercentage)||0,M=n==="govTaxPercentage"?parseFloat(d)||0:parseFloat(l.govTaxPercentage)||0,y=Math.round(k/100*b*100)/100;c.adminProfitAmount=y;const f=Math.round((b+y)*100)/100;c.sellingPrice=f;const F=Math.round(S/100*b*100)/100;c.userCommissionAmount=F;const v=Math.round(M/100*f*100)/100;c.govTaxAmount=v;const E=Math.round((f+v)*100)/100;c.sellingWithTaxPrice=E}return c}),r[n]&&x(l=>({...l,[n]:null}))},A=()=>{const s={};return a.headOfficeId||(s.headOfficeId="Head Office is required"),a.menuName||(s.menuName="Menu name is required"),a.menuType||(s.menuType="Menu type is required"),a.buyingPrice<0&&(s.buyingPrice="Buying price cannot be negative"),a.sellingPrice<0&&(s.sellingPrice="Selling price cannot be negative"),(a.adminProfitPercentage<0||a.adminProfitPercentage>100)&&(s.adminProfitPercentage="Admin profit percentage must be between 0 and 100"),(a.userCommissionPercentage<0||a.userCommissionPercentage>100)&&(s.userCommissionPercentage="User commission percentage must be between 0 and 100"),x(s),Object.keys(s).length===0},w=async s=>{if(s.preventDefault(),!!A()){h(!0);try{W.put(`/menu-items/${i.id}`,a,{onSuccess:n=>{var o;if((o=n.props.flash)!=null&&o.success&&console.log(n.props.flash.success),n.props.menuItem)P(n.props.menuItem);else{const p={...i,...a,updated_at:new Date().toISOString()};P(p)}},onError:n=>{x(n)},onFinish:()=>{h(!1)}})}catch(n){console.error("Error updating menu item:",n),h(!1)}}};return i?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Edit Menu Item: ",i.menuName]}),e.jsx("button",{onClick:j,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Office Selection"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Head Office *"})}),e.jsxs("select",{name:"headOfficeId",value:a.headOfficeId,onChange:t,className:`select select-bordered w-full ${r.headOfficeId?"select-error":""}`,children:[e.jsx("option",{value:"",children:"Select Head Office"}),C.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]}),r.headOfficeId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.headOfficeId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Branch Office"})}),e.jsxs("select",{name:"branchId",value:a.branchId,onChange:t,className:"select select-bordered w-full",children:[e.jsx("option",{value:"",children:"Select Branch Office (Optional)"}),T.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Menu Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Menu Name *"})}),e.jsx("input",{type:"text",name:"menuName",value:a.menuName,onChange:t,className:`input input-bordered w-full ${r.menuName?"input-error":""}`,placeholder:"e.g., Chicken Burger, Coffee"}),r.menuName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.menuName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Menu Type *"})}),e.jsxs("select",{name:"menuType",value:a.menuType,onChange:t,className:`select select-bordered w-full ${r.menuType?"select-error":""}`,children:[e.jsx("option",{value:"food",children:"Food"}),e.jsx("option",{value:"drink",children:"Drink"})]}),r.menuType&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.menuType})]})]}),a.menuType==="drink"&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Drink Amount (ml)"})}),e.jsx("input",{type:"number",name:"drinkAmount",value:a.drinkAmount,onChange:t,className:"input input-bordered w-full",placeholder:"e.g., 250",step:"0.01"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Pricing Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Buying Price (₹)"})}),e.jsx("input",{type:"number",name:"buyingPrice",value:a.buyingPrice,onChange:t,className:`input input-bordered w-full ${r.buyingPrice?"input-error":""}`,placeholder:"0.00",step:"0.01",min:"0"}),r.buyingPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.buyingPrice})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Selling Price (₹)"})}),e.jsx("input",{type:"number",name:"sellingPrice",value:a.sellingPrice,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"}),r.sellingPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.sellingPrice})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Profit & Commission"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Admin Profit Percentage (%)"})}),e.jsx("input",{type:"number",name:"adminProfitPercentage",value:a.adminProfitPercentage,onChange:t,className:`input input-bordered w-full ${r.adminProfitPercentage?"input-error":""}`,placeholder:"0",min:"0",max:"100"}),r.adminProfitPercentage&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.adminProfitPercentage})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Admin Profit Amount (₹)"})}),e.jsx("input",{type:"number",name:"adminProfitAmount",value:a.adminProfitAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"User Commission Percentage (%)"})}),e.jsx("input",{type:"number",name:"userCommissionPercentage",value:a.userCommissionPercentage,onChange:t,className:`input input-bordered w-full ${r.userCommissionPercentage?"input-error":""}`,placeholder:"0",min:"0",max:"100"}),r.userCommissionPercentage&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.userCommissionPercentage})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"User Commission Amount (₹)"})}),e.jsx("input",{type:"number",name:"userCommissionAmount",value:a.userCommissionAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Government Tax"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Government Tax Percentage (%)"})}),e.jsx("input",{type:"number",name:"govTaxPercentage",value:a.govTaxPercentage,onChange:t,className:"input input-bordered w-full",placeholder:"0",min:"0",max:"100",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Government Tax Amount (₹)"})}),e.jsx("input",{type:"number",name:"govTaxAmount",value:a.govTaxAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Selling Price with Tax (₹)"})}),e.jsx("input",{type:"number",name:"sellingWithTaxPrice",value:a.sellingWithTaxPrice,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Status"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"activeStatus",checked:a.activeStatus===1,onChange:s=>u(n=>({...n,activeStatus:s.target.checked?1:0})),className:"checkbox checkbox-primary mr-3"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active Status"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:j,className:"btn btn-ghost",disabled:g,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Updating..."]}):"Update Menu Item"})]})]})]})}):null}export{D as default};
