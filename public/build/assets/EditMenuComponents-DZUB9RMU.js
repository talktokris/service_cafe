import{r as x,j as e,b as B}from"./app-BF4HM74z.js";function D({menuItem:n,onClose:v,onSuccess:T,officeProfiles:C=[]}){const[a,g]=x.useState({headOfficeId:"",branchId:"",menuName:"",menuType:"food",drinkAmount:0,buyingPrice:0,adminProfitPercentage:0,adminProfitAmount:0,userCommissionPercentage:0,userCommissionAmount:0,sellingPrice:0,govTaxPercentage:0,govTaxAmount:0,sellingWithTaxPrice:0,activeStatus:1}),[i,h]=x.useState({}),[p,b]=x.useState(!1),O=C.filter(s=>s.profileType==="HeadOffice"&&s.deleteStatus===0),S=C.filter(s=>s.profileType==="BranchOffice"&&s.deleteStatus===0);x.useEffect(()=>{n&&g({headOfficeId:n.headOfficeId||"",branchId:n.branchId||"",menuName:n.menuName||"",menuType:n.menuType||"food",drinkAmount:n.drinkAmount||0,buyingPrice:n.buyingPrice||0,adminProfitPercentage:n.adminProfitPercentage||0,adminProfitAmount:n.adminProfitAmount||0,userCommissionPercentage:n.userCommissionPercentage||0,userCommissionAmount:n.userCommissionAmount||0,sellingPrice:n.sellingPrice||0,govTaxPercentage:n.govTaxPercentage||"",govTaxAmount:n.govTaxAmount||"",sellingWithTaxPrice:n.sellingWithTaxPrice||0,activeStatus:n.activeStatus||0})},[n]);const l=s=>{const{name:r,value:u,type:f,checked:M}=s.target,F=f==="checkbox"?M:u;g(d=>{const t={...d,[r]:F};if(r==="buyingPrice"||r==="sellingPrice"){const o=parseFloat(t.buyingPrice)||0,c=parseFloat(t.sellingPrice)||0;if(o>0&&c>0){const A=Math.round((c-o)*100)/100;t.adminProfitAmount=A;const W=Math.round(A/o*100*100)/100;t.adminProfitPercentage=W}else t.adminProfitAmount=0,t.adminProfitPercentage=0;const j=parseFloat(d.userCommissionPercentage)||0,P=parseFloat(d.govTaxPercentage)||0,N=Math.round(j/100*o*100)/100;t.userCommissionAmount=N;const m=Math.round(P/100*c*100)/100;t.govTaxAmount=m;const y=Math.round((c+m)*100)/100;t.sellingWithTaxPrice=y}if(r==="userCommissionPercentage"||r==="govTaxPercentage"){const o=parseFloat(t.buyingPrice)||0,c=parseFloat(t.sellingPrice)||0,j=parseFloat(t.userCommissionPercentage)||0,P=parseFloat(t.govTaxPercentage)||0,N=Math.round(j/100*o*100)/100;t.userCommissionAmount=N;const m=Math.round(P/100*c*100)/100;t.govTaxAmount=m;const y=Math.round((c+m)*100)/100;t.sellingWithTaxPrice=y}return t}),i[r]&&h(d=>({...d,[r]:null}))},w=()=>{const s={};return a.headOfficeId||(s.headOfficeId="Head Office is required"),a.menuName||(s.menuName="Menu name is required"),a.menuType||(s.menuType="Menu type is required"),a.buyingPrice<0&&(s.buyingPrice="Buying price cannot be negative"),a.sellingPrice<0&&(s.sellingPrice="Selling price cannot be negative"),a.adminProfitPercentage<0&&(s.adminProfitPercentage="Admin profit percentage must be 0 or greater"),a.userCommissionPercentage<0&&(s.userCommissionPercentage="User commission percentage must be 0 or greater"),h(s),Object.keys(s).length===0},k=async s=>{if(s.preventDefault(),!!w()){b(!0);try{B.put(`/menu-items/${n.id}`,a,{onSuccess:r=>{var u;if((u=r.props.flash)!=null&&u.success&&console.log(r.props.flash.success),r.props.menuItem)T(r.props.menuItem);else{const f={...n,...a,updated_at:new Date().toISOString()};T(f)}},onError:r=>{h(r)},onFinish:()=>{b(!1)}})}catch(r){console.error("Error updating menu item:",r),b(!1)}}};return n?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Edit Menu Item: ",n.menuName]}),e.jsx("button",{onClick:v,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:k,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Office Selection"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Head Office *"})}),e.jsxs("select",{name:"headOfficeId",value:a.headOfficeId,onChange:l,className:`select select-bordered w-full ${i.headOfficeId?"select-error":""}`,children:[e.jsx("option",{value:"",children:"Select Head Office"}),O.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]}),i.headOfficeId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.headOfficeId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Branch Office"})}),e.jsxs("select",{name:"branchId",value:a.branchId,onChange:l,className:"select select-bordered w-full",children:[e.jsx("option",{value:"",children:"Select Branch Office (Optional)"}),S.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Menu Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Menu Name *"})}),e.jsx("input",{type:"text",name:"menuName",value:a.menuName,onChange:l,className:`input input-bordered w-full ${i.menuName?"input-error":""}`,placeholder:"e.g., Chicken Burger, Coffee"}),i.menuName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.menuName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Menu Type *"})}),e.jsxs("select",{name:"menuType",value:a.menuType,onChange:l,className:`select select-bordered w-full ${i.menuType?"select-error":""}`,children:[e.jsx("option",{value:"food",children:"Food"}),e.jsx("option",{value:"drink",children:"Drink"})]}),i.menuType&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.menuType})]})]}),a.menuType==="drink"&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Drink Amount (ml)"})}),e.jsx("input",{type:"number",name:"drinkAmount",value:a.drinkAmount,onChange:l,className:"input input-bordered w-full",placeholder:"e.g., 250",step:"0.01"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Pricing Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Buying Price (₹)"})}),e.jsx("input",{type:"number",name:"buyingPrice",value:a.buyingPrice,onChange:l,className:`input input-bordered w-full ${i.buyingPrice?"input-error":""}`,placeholder:"0.00",step:"0.01",min:"0"}),i.buyingPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.buyingPrice})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Selling Price (₹)"})}),e.jsx("input",{type:"number",name:"sellingPrice",value:a.sellingPrice,onChange:l,className:`input input-bordered w-full ${i.sellingPrice?"input-error":""}`,placeholder:"0.00",step:"0.01",min:"0"}),i.sellingPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.sellingPrice})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Profit & Commission"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Admin Profit Percentage (%)"})}),e.jsx("input",{type:"number",name:"adminProfitPercentage",value:a.adminProfitPercentage,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-calculated from Buying Price and Selling Price"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Admin Profit Amount (₹)"})}),e.jsx("input",{type:"number",name:"adminProfitAmount",value:a.adminProfitAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-calculated from Buying Price and Selling Price"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"User Commission Percentage (%)"})}),e.jsx("input",{type:"number",name:"userCommissionPercentage",value:a.userCommissionPercentage,onChange:l,className:`input input-bordered w-full ${i.userCommissionPercentage?"input-error":""}`,placeholder:"0",min:"0"}),i.userCommissionPercentage&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.userCommissionPercentage})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"User Commission Amount (₹)"})}),e.jsx("input",{type:"number",name:"userCommissionAmount",value:a.userCommissionAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Government Tax"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Government Tax Percentage (%)"})}),e.jsx("input",{type:"number",name:"govTaxPercentage",value:a.govTaxPercentage,onChange:l,className:"input input-bordered w-full",placeholder:"0",min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Government Tax Amount (₹)"})}),e.jsx("input",{type:"number",name:"govTaxAmount",value:a.govTaxAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Selling Price with Tax (₹)"})}),e.jsx("input",{type:"number",name:"sellingWithTaxPrice",value:a.sellingWithTaxPrice,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Status"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"activeStatus",checked:a.activeStatus===1,onChange:s=>g(r=>({...r,activeStatus:s.target.checked?1:0})),className:"checkbox checkbox-primary mr-3"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active Status"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:v,className:"btn btn-ghost",disabled:p,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Updating..."]}):"Update Menu Item"})]})]})]})}):null}export{D as default};
