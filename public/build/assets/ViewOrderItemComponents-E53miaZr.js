import{r as c,j as e}from"./app-Cy0UIO-x.js";function f({order:i,onClose:m}){const[d,o]=c.useState([]),[h,x]=c.useState(!0);c.useEffect(()=>{u()},[i.id]);const u=async()=>{try{x(!0);const t=await(await fetch(`/order-items?orderId=${i.id}&headOfficeId=${i.headOfficeId}&branchId=${i.branchId}&tableId=${i.tableId}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin"})).json();t.success?o(t.orderItems):(console.error("Failed to fetch order items:",t.message),o([]))}catch(s){console.error("Error fetching order items:",s),o([])}finally{x(!1)}},n=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s||0),r=d.reduce((t,a)=>{const l=parseInt(a.quantity)||0;return t.buyingPrice+=(parseFloat(a.buyingPrice)||0)*l,t.sellingPrice+=(parseFloat(a.sellingPrice)||0)*l,t.taxAmount+=parseFloat(a.taxAmount)||0,t.adminProfitAmount+=(parseFloat(a.adminProfitAmount)||0)*l,t.adminNetProfitAmount+=(parseFloat(a.adminNetProfitAmount)||0)*l,t.userCommissionAmount+=(parseFloat(a.userCommissionAmount)||0)*l,t.subTotalAmount+=parseFloat(a.subTotalAmount)||0,t.totalQuantity+=l,t},{buyingPrice:0,sellingPrice:0,taxAmount:0,adminProfitAmount:0,adminNetProfitAmount:0,userCommissionAmount:0,subTotalAmount:0,totalQuantity:0});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full h-[90vh] flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Order Items - #",i.id]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Complete list of items in this order"})]}),e.jsx("button",{onClick:m,className:"btn btn-ghost btn-circle",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"p-6 flex-1 overflow-y-auto",children:h?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"loading loading-spinner loading-lg"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading order items..."})]}):d.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-zebra w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Buying Price"}),e.jsx("th",{children:"Selling Price"}),e.jsx("th",{children:"Tax Amount"}),e.jsx("th",{children:"Sub Total"}),e.jsx("th",{children:"Admin Profit"}),e.jsx("th",{children:"User Commission"})]})}),e.jsx("tbody",{children:d.map(s=>{var t,a,l;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((t=s.menuItem)==null?void 0:t.menuName)||"Unknown Item"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",s.menuId]})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${((a=s.menuItem)==null?void 0:a.menuType)==="food"?"badge-primary":"badge-secondary"}`,children:((l=s.menuItem)==null?void 0:l.menuType)||"N/A"})}),e.jsx("td",{className:"text-center font-medium",children:s.quantity}),e.jsx("td",{className:"font-medium",children:n(s.buyingPrice)}),e.jsx("td",{className:"font-medium",children:n(s.sellingPrice)}),e.jsx("td",{className:"font-medium",children:n(s.taxAmount)}),e.jsx("td",{className:"font-medium text-green-600",children:n(s.subTotalAmount)}),e.jsx("td",{className:"font-medium text-blue-600",children:n(s.adminProfitAmount)}),e.jsx("td",{className:"font-medium text-purple-600",children:n(s.userCommissionAmount)})]},s.id)})})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r.totalQuantity}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Items"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n(r.buyingPrice)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Buying"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n(r.sellingPrice)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Selling"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-blue-600",children:n(r.taxAmount)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Tax"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-green-600",children:n(r.adminProfitAmount)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Admin Profit"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-purple-600",children:n(r.userCommissionAmount)}),e.jsx("div",{className:"text-sm text-gray-500",children:"User Commission"})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Financial Breakdown"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal (Before Tax):"}),e.jsx("span",{className:"font-medium",children:n(r.sellingPrice)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-600",children:"Tax Amount:"}),e.jsx("span",{className:"font-medium text-blue-600",children:n(r.taxAmount)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-600",children:"Discount Amount:"}),e.jsx("span",{className:"font-medium text-red-600",children:n(i.discountAmount||0)})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-t-2 border-gray-200",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Final Total:"}),e.jsx("span",{className:"text-xl font-bold text-green-600",children:n(r.sellingPrice+r.taxAmount-(i.discountAmount||0))})]})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Items Found"}),e.jsx("p",{className:"text-gray-500",children:"This order doesn't have any items yet."})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end flex-shrink-0 bg-gray-50",children:e.jsx("button",{onClick:m,className:"btn btn-ghost",children:"Close"})})]})})}export{f as default};
