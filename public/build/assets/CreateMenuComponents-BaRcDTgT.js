import{r as g,j as e,b as L}from"./app-ey5GbxPF.js";function $({onClose:C,onSuccess:T,officeProfiles:A=[]}){const[s,w]=g.useState({headOfficeId:"",branchId:"",menuName:"",menuType:"food",drinkAmount:0,buyingPrice:0,adminProfitPercentage:0,adminProfitAmount:0,userCommissionPercentage:0,userCommissionAmount:0,sellingPrice:0,govTaxPercentage:"",govTaxAmount:"",sellingWithTaxPrice:0,activeStatus:1}),[n,x]=g.useState({}),[h,b]=g.useState(!1),[S,o]=g.useState(""),[F,f]=g.useState(""),O=A.filter(a=>a.profileType==="HeadOffice"&&a.deleteStatus===0),M=A.filter(a=>a.profileType==="BranchOffice"&&a.deleteStatus===0),l=a=>{const{name:r,value:t,type:p,checked:P}=a.target,D=p==="checkbox"?P:t;w(d=>{const i={...d,[r]:D};if(r==="buyingPrice"||r==="sellingPrice"){const m=parseFloat(i.buyingPrice)||0,c=parseFloat(i.sellingPrice)||0;if(m>0&&c>0){const k=Math.round((c-m)*100)/100;i.adminProfitAmount=k;const W=Math.round(k/m*100*100)/100;i.adminProfitPercentage=W}else i.adminProfitAmount=0,i.adminProfitPercentage=0;const j=parseFloat(d.userCommissionPercentage)||0,v=parseFloat(d.govTaxPercentage)||0,N=Math.round(j/100*m*100)/100;i.userCommissionAmount=N;const u=Math.round(v/100*c*100)/100;i.govTaxAmount=u;const y=Math.round((c+u)*100)/100;i.sellingWithTaxPrice=y}if(r==="userCommissionPercentage"||r==="govTaxPercentage"){const m=parseFloat(i.buyingPrice)||0,c=parseFloat(i.sellingPrice)||0,j=parseFloat(i.userCommissionPercentage)||0,v=parseFloat(i.govTaxPercentage)||0,N=Math.round(j/100*m*100)/100;i.userCommissionAmount=N;const u=Math.round(v/100*c*100)/100;i.govTaxAmount=u;const y=Math.round((c+u)*100)/100;i.sellingWithTaxPrice=y}return i}),n[r]&&x(d=>({...d,[r]:null}))},I=()=>{const a={};return x({}),o(""),f(""),s.headOfficeId||(a.headOfficeId="Head Office is required"),!s.menuName||s.menuName.trim()===""?a.menuName="Menu name is required":s.menuName.length>255&&(a.menuName="Menu name must be less than 255 characters"),s.menuType||(a.menuType="Menu type is required"),s.buyingPrice===""||s.buyingPrice===null||s.buyingPrice===void 0?a.buyingPrice="Buying price is required":parseFloat(s.buyingPrice)<0?a.buyingPrice="Buying price cannot be negative":isNaN(parseFloat(s.buyingPrice))&&(a.buyingPrice="Buying price must be a valid number"),s.sellingPrice===""||s.sellingPrice===null||s.sellingPrice===void 0?a.sellingPrice="Selling price is required":parseFloat(s.sellingPrice)<0?a.sellingPrice="Selling price cannot be negative":isNaN(parseFloat(s.sellingPrice))&&(a.sellingPrice="Selling price must be a valid number"),parseFloat(s.buyingPrice)>0&&parseFloat(s.sellingPrice)>0&&parseFloat(s.sellingPrice)<=parseFloat(s.buyingPrice)&&(a.sellingPrice="Selling price must be greater than buying price"),s.userCommissionPercentage!==""&&s.userCommissionPercentage!==null&&s.userCommissionPercentage!==void 0&&(parseFloat(s.userCommissionPercentage)<0?a.userCommissionPercentage="User commission percentage must be 0 or greater":isNaN(parseFloat(s.userCommissionPercentage))&&(a.userCommissionPercentage="User commission percentage must be a valid number")),s.govTaxPercentage!==""&&s.govTaxPercentage!==null&&s.govTaxPercentage!==void 0&&(parseFloat(s.govTaxPercentage)<0?a.govTaxPercentage="Government tax percentage must be 0 or greater":isNaN(parseFloat(s.govTaxPercentage))&&(a.govTaxPercentage="Government tax percentage must be a valid number")),s.menuType==="drink"&&s.drinkAmount!==""&&s.drinkAmount!==null&&s.drinkAmount!==void 0&&(parseFloat(s.drinkAmount)<0?a.drinkAmount="Drink amount cannot be negative":isNaN(parseFloat(s.drinkAmount))&&(a.drinkAmount="Drink amount must be a valid number")),x(a),Object.keys(a).length===0},B=async a=>{if(a.preventDefault(),!I()){o("Please fix the validation errors below");return}b(!0),o(""),f("");try{const r={...s,buyingPrice:parseFloat(s.buyingPrice)||0,sellingPrice:parseFloat(s.sellingPrice)||0,adminProfitPercentage:parseFloat(s.adminProfitPercentage)||0,adminProfitAmount:parseFloat(s.adminProfitAmount)||0,userCommissionPercentage:parseFloat(s.userCommissionPercentage)||0,userCommissionAmount:parseFloat(s.userCommissionAmount)||0,govTaxPercentage:parseFloat(s.govTaxPercentage)||0,govTaxAmount:parseFloat(s.govTaxAmount)||0,sellingWithTaxPrice:parseFloat(s.sellingWithTaxPrice)||0,drinkAmount:parseFloat(s.drinkAmount)||0,activeStatus:s.activeStatus?1:0};L.post("/menu-items",r,{onSuccess:t=>{var p;if((p=t.props.flash)!=null&&p.success&&f(t.props.flash.success),t.props.menuItem)T(t.props.menuItem);else{const P={id:Date.now(),...s,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};T(P)}},onError:t=>{x(t),typeof t=="object"&&Object.keys(t).length>0?o("Please fix the validation errors below"):o("An error occurred while creating the menu item. Please try again.")},onFinish:()=>{b(!1)}})}catch{o("An unexpected error occurred. Please try again."),b(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Menu Item"}),e.jsx("button",{onClick:C,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:B,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Office Selection"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Head Office *"})}),e.jsxs("select",{name:"headOfficeId",value:s.headOfficeId,onChange:l,className:`select select-bordered w-full ${n.headOfficeId?"select-error":""}`,children:[e.jsx("option",{value:"",children:"Select Head Office"}),O.map(a=>e.jsx("option",{value:a.id,children:a.companyName},a.id))]}),n.headOfficeId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.headOfficeId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Branch Office"})}),e.jsxs("select",{name:"branchId",value:s.branchId,onChange:l,className:"select select-bordered w-full",children:[e.jsx("option",{value:"",children:"Select Branch Office (Optional)"}),M.map(a=>e.jsx("option",{value:a.id,children:a.companyName},a.id))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Menu Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Menu Name *"})}),e.jsx("input",{type:"text",name:"menuName",value:s.menuName,onChange:l,className:`input input-bordered w-full ${n.menuName?"input-error":""}`,placeholder:"e.g., Chicken Burger, Coffee"}),n.menuName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.menuName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Menu Type *"})}),e.jsxs("select",{name:"menuType",value:s.menuType,onChange:l,className:`select select-bordered w-full ${n.menuType?"select-error":""}`,children:[e.jsx("option",{value:"food",children:"Food"}),e.jsx("option",{value:"drink",children:"Drink"})]}),n.menuType&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.menuType})]})]}),s.menuType==="drink"&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Drink Amount (ml)"})}),e.jsx("input",{type:"number",name:"drinkAmount",value:s.drinkAmount,onChange:l,className:"input input-bordered w-full",placeholder:"e.g., 250",step:"0.01"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Pricing Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Buying Price (₹)"})}),e.jsx("input",{type:"number",name:"buyingPrice",value:s.buyingPrice,onChange:l,className:`input input-bordered w-full ${n.buyingPrice?"input-error":""}`,placeholder:"0.00",step:"0.01",min:"0"}),n.buyingPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.buyingPrice})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Selling Price (₹)"})}),e.jsx("input",{type:"number",name:"sellingPrice",value:s.sellingPrice,onChange:l,className:`input input-bordered w-full ${n.sellingPrice?"input-error":""}`,placeholder:"0.00",step:"0.01",min:"0"}),n.sellingPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.sellingPrice})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Profit & Commission"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Admin Profit Percentage (%)"})}),e.jsx("input",{type:"number",name:"adminProfitPercentage",value:s.adminProfitPercentage,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-calculated from Buying Price and Selling Price"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Admin Profit Amount (₹)"})}),e.jsx("input",{type:"number",name:"adminProfitAmount",value:s.adminProfitAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-calculated from Buying Price and Selling Price"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"User Commission Percentage (%)"})}),e.jsx("input",{type:"number",name:"userCommissionPercentage",value:s.userCommissionPercentage,onChange:l,className:`input input-bordered w-full ${n.userCommissionPercentage?"input-error":""}`,placeholder:"0",min:"0"}),n.userCommissionPercentage&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.userCommissionPercentage})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"User Commission Amount (₹)"})}),e.jsx("input",{type:"number",name:"userCommissionAmount",value:s.userCommissionAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Government Tax"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Government Tax Percentage (%)"})}),e.jsx("input",{type:"number",name:"govTaxPercentage",value:s.govTaxPercentage,onChange:l,className:"input input-bordered w-full",placeholder:"0",min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Government Tax Amount (₹)"})}),e.jsx("input",{type:"number",name:"govTaxAmount",value:s.govTaxAmount,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Selling Price with Tax (₹)"})}),e.jsx("input",{type:"number",name:"sellingWithTaxPrice",value:s.sellingWithTaxPrice,readOnly:!0,className:"input input-bordered w-full bg-gray-100",placeholder:"0.00",step:"0.01",min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Status"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"activeStatus",checked:s.activeStatus===1,onChange:a=>w(r=>({...r,activeStatus:a.target.checked?1:0})),className:"checkbox checkbox-primary mr-3"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active Status"})]})]}),S&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-red-700 font-medium",children:S})]})}),F&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-green-700 font-medium",children:F})]})}),e.jsx("div",{className:"flex justify-between items-center pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:C,className:"btn btn-ghost",disabled:h,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Creating..."]}):"Create Menu Item"})]})})]})]})})}export{$ as default};
