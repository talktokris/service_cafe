import{r,j as e}from"./app-Cy0UIO-x.js";import J from"./CreateUserControlComponents-DQZ8CnCj.js";import K from"./ViewUserControlComponents-DRjBinjw.js";import P from"./EditUserControlComponents-DvxcMkc2.js";import Q from"./DeleteUserControlComponents-D8ZnCB1g.js";import X from"./ChangePasswordComponents-D7UOfdfm.js";import Y from"./ChangeRoleComponents-CPfw6VMz.js";function de({user:Z,users:h=[],officeProfiles:c=[]}){const[i,m]=r.useState(h),[k,x]=r.useState(!1),[S,N]=r.useState(!1),[M,f]=r.useState(!1),[O,g]=r.useState(!1),[U,j]=r.useState(!1),[H,u]=r.useState(!1),[d,n]=r.useState(null),[p,w]=r.useState("all"),[b,y]=r.useState("all"),[v,o]=r.useState(h);r.useEffect(()=>{m(h),o(h)},[h]);const B=c.filter(s=>s.profileType==="HeadOffice"&&s.deleteStatus===0),D=c.filter(s=>s.profileType==="BranchOffice"&&s.deleteStatus===0),R=()=>{const s=i.filter(a=>{const t=p==="all"||a.headOfficeId==p,l=b==="all"||a.branchId==b;return t&&l&&a.deleteStatus===0&&a.user_type!=="member"});o(s)},E=()=>{w("all"),y("all"),o(i.filter(s=>s.deleteStatus===0&&s.user_type!=="member"))},F=s=>{console.log("New user received in handleCreateUser:",s),m(a=>{const t=[...a,s];return console.log("Updated users data:",t),t}),o(a=>{const t=[...a,s];return console.log("Updated filtered data:",t),t}),x(!1)},L=s=>{m(a=>{const t=a.map(l=>l.id===s.id?s:l);return console.log("Updated users data after edit:",t),t}),o(a=>{const t=a.map(l=>l.id===s.id?s:l);return console.log("Updated filtered data after edit:",t),t}),f(!1),n(null)},_=s=>{m(a=>{const t=a.map(l=>l.id===s?{...l,deleteStatus:1}:l);return console.log("Updated users data after delete:",t),t}),o(a=>{const t=a.map(l=>l.id===s?{...l,deleteStatus:1}:l);return console.log("Updated filtered data after delete:",t),t}),g(!1),n(null)},z=()=>{j(!1),n(null)},A=s=>{m(a=>{const t=a.map(l=>l.id===s.id?s:l);return console.log("Updated users data after role change:",t),t}),o(a=>{const t=a.map(l=>l.id===s.id?s:l);return console.log("Updated filtered data after role change:",t),t}),u(!1),n(null)},V=s=>{n(s),N(!0)},W=s=>{n(s),f(!0)},T=s=>{n(s),g(!0)},I=s=>{n(s),j(!0)},$=s=>{n(s),u(!0)},C=(s,a)=>{if(!s)return"N/A";const t=c.find(l=>l.id==s);return t?t.companyName:"Unknown"},q=s=>({headoffice:"Head Office",branchOffice:"Branch Office",member:"Member"})[s]||s,G=s=>s.roles&&s.roles.length>0?s.roles[0].name:"No Role";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage users for head offices and branch offices"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"btn bg-red-600 hover:bg-red-700 text-white",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add New User"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(s=>s.deleteStatus===0&&s.user_type!=="member").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Active Users"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(s=>s.activeStatus===1&&s.deleteStatus===0&&s.user_type!=="member").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Head Office Users"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(s=>s.user_type==="headoffice"&&s.deleteStatus===0).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Branch Office Users"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(s=>s.user_type==="branchOffice"&&s.deleteStatus===0).length})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Head Office"})}),e.jsxs("select",{value:p,onChange:s=>w(s.target.value),className:"select select-bordered w-full",children:[e.jsx("option",{value:"all",children:"All Head Offices"}),B.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Branch Office"})}),e.jsxs("select",{value:b,onChange:s=>y(s.target.value),className:"select select-bordered w-full",children:[e.jsx("option",{value:"all",children:"All Branch Offices"}),D.map(s=>e.jsx("option",{value:s.id,children:s.companyName},s.id))]})]}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsx("button",{onClick:R,className:"btn btn-primary",children:"Filter"}),e.jsx("button",{onClick:E,className:"btn btn-ghost",children:"Reset"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Users (",v.length,")"]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-zebra w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"User Type"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Head Office"}),e.jsx("th",{children:"Branch Office"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:v.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"No users found"})}):v.map(s=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsxs("div",{className:"font-bold",children:[s.first_name," ",s.last_name]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.name})]}),e.jsx("td",{children:e.jsx("span",{className:"font-medium",children:s.email})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.user_type==="headoffice"?"badge-primary":"badge-secondary"}`,children:q(s.user_type)})}),e.jsx("td",{children:e.jsx("span",{className:"font-medium",children:G(s)})}),e.jsx("td",{children:C(s.headOfficeId)}),e.jsx("td",{children:C(s.branchId)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.activeStatus===1?"badge-success":"badge-warning"}`,children:s.activeStatus===1?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("button",{onClick:()=>V(s),className:"btn btn-ghost btn-xs text-green-600 hover:bg-green-50",children:"View"}),e.jsx("button",{onClick:()=>W(s),className:"btn btn-ghost btn-xs text-blue-600 hover:bg-blue-50",children:"Edit"}),e.jsx("button",{onClick:()=>I(s),className:"btn btn-ghost btn-xs text-purple-600 hover:bg-purple-50",children:"Password"}),e.jsx("button",{onClick:()=>$(s),className:"btn btn-ghost btn-xs text-orange-600 hover:bg-orange-50",children:"Role"}),e.jsx("button",{onClick:()=>T(s),className:"btn btn-ghost btn-xs text-red-600 hover:bg-red-50",children:"Delete"})]})})]},s.id))})]})})})]}),k&&e.jsx(J,{onClose:()=>x(!1),onSuccess:F,officeProfiles:c}),S&&d&&e.jsx(K,{user:d,onClose:()=>{N(!1),n(null)},officeProfiles:c}),M&&d&&e.jsx(P,{user:d,onClose:()=>{f(!1),n(null)},onSuccess:L,officeProfiles:c}),O&&d&&e.jsx(Q,{user:d,onClose:()=>{g(!1),n(null)},onSuccess:_}),U&&d&&e.jsx(X,{user:d,onClose:()=>{j(!1),n(null)},onSuccess:z}),H&&d&&e.jsx(Y,{user:d,onClose:()=>{u(!1),n(null)},onSuccess:A,officeProfiles:c})]})}export{de as default};
