import{r as m,j as e}from"./app-CeALoAiy.js";function A({table:x,user:r,order:u,onClose:b,onSuccess:I,menuItems:w=[]}){const[f,j]=m.useState(""),[s,N]=m.useState(null),[n,i]=m.useState(1),[h,p]=m.useState(!1),y=w.filter(t=>{var a;return(a=t.menuName)==null?void 0:a.toLowerCase().includes(f.toLowerCase())}),o=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(t||0),S=t=>{N(t),i(1)},P=async t=>{var a;if(t.preventDefault(),!s||!r||!u){console.error("Missing required data:",{selectedMenuItem:s,user:r,order:u});return}p(!0);try{const d=s.govTaxPercentage||0,g=Math.round(d/100*s.sellingPrice*n*100)/100,v=Math.round((s.sellingPrice*n+g)*100)/100,k={headOfficeId:r.headOfficeId,branchId:r.branchId,createUserId:r.id,tableId:x.id,orderId:u.id,menuId:s.id,buyingPrice:s.buyingPrice,sellingPrice:s.sellingPrice,adminProfitAmount:s.adminProfitAmount,adminNetProfitAmount:s.adminProfitAmount,userCommissionAmount:s.userCommissionAmount,quantity:n,taxAmount:g,subTotalAmount:v};console.log("Submitting order item:",k);const c=await fetch("/order-items",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||"",Accept:"application/json"},body:JSON.stringify(k)});if(console.log("Response status:",c.status),!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const l=await c.json();console.log("Response result:",l),l.success?(I({tableId:x.id,menuItemId:s.id,quantity:n,total:v,taxAmount:g,orderItem:l.orderItem}),N(null),i(1),j("")):(console.error("Error adding menu item:",l.message),alert("Error adding menu item: "+(l.message||"Unknown error")))}catch(d){console.error("Error adding menu item:",d),alert("Error adding menu item: "+d.message)}finally{p(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full h-[700px] flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Add Menu Item - Table ",x.tableShortName]}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden h-[600px]",children:[e.jsxs("div",{className:"flex-1 p-6 border-r border-gray-200 flex flex-col",children:[e.jsx("div",{className:"mb-4 flex-shrink-0",children:e.jsx("input",{type:"text",placeholder:"Search menu items...",value:f,onChange:t=>j(t.target.value),className:"input input-bordered w-full"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:y.length===0?e.jsx("div",{className:"col-span-2 text-center py-8 text-gray-500",children:"No menu items found"}):y.map(t=>e.jsxs("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors duration-200 ${(s==null?void 0:s.id)===t.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>S(t),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:t.menuName}),e.jsx("span",{className:`badge badge-sm ${t.menuType==="food"?"badge-primary":"badge-secondary"}`,children:t.menuType})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:t.tableShortFullName||"Menu item"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-bold text-green-600",children:o(t.sellingPrice)}),t.menuType==="drink"&&t.drinkAmount&&e.jsxs("span",{className:"text-xs text-gray-500",children:[t.drinkAmount,"ml"]})]})]},t.id))})})]}),e.jsx("div",{className:"w-96 p-6 flex flex-col",children:s?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Selected Item Details"}),e.jsxs("div",{className:"space-y-4 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Menu Item"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.menuName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Price"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:o(s.sellingPrice)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Quantity"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>i(Math.max(1,n-1)),className:"btn btn-sm btn-outline",children:"-"}),e.jsx("span",{className:"text-lg font-semibold px-4",children:n}),e.jsx("button",{onClick:()=>i(n+1),className:"btn btn-sm btn-outline",children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Total Amount"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:o(s.sellingPrice*n)})]})]})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Menu Item"}),e.jsx("p",{className:"text-gray-500",children:"Click on any menu item from the list to see details and add to order"})]})})})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center space-x-4",children:s&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Selected:"})," ",s.menuName,e.jsx("span",{className:"ml-2 font-semibold text-green-600",children:o(s.sellingPrice*n)})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:b,className:"btn btn-ghost",disabled:h,children:"Cancel"}),e.jsx("button",{onClick:P,className:"btn btn-primary",disabled:!s||h,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Adding..."]}):"Add to Order"})]})]})})]})})}export{A as default};
